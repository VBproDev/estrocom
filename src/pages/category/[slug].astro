---
/* ============================
   IMPORTS & SETUP
   ============================ */
import Layout from "../../layouts/Layout.astro";
import { Image } from "astro:assets";
import Text from "../../components/atoms/Text.astro";
import FeaturedProducts from "../../components/organisms/FeaturedProducts.astro";
import Outro from "../../components/organisms/Outro.astro";
import Footer from "../../components/organisms/Footer.astro";
import Button from "../../components/atoms/Button.astro";
import MakhanaBenefits from "../../components/molecules/MakhanaBenefits.astro";
import SattuBenefits from "../../components/molecules/SattuBenefits.astro";
import { data } from "../../utils/productData.js";
import { colors } from "../../design-system/colors.js";

/* ============================
   STATIC PATHS FOR ROUTING
   ============================ */
export async function getStaticPaths() {
    return [
        { params: { slug: "makhana" }, props: { type: "makhana" } },
        { params: { slug: "sattu" }, props: { type: "sattu" } },
    ];
}

/* ============================
   PROPS & VARIABLES
   ============================ */
interface Props {
    type: string;
}

const { type } = Astro.props;
const categoryName = type.charAt(0).toUpperCase() + type.slice(1);

/* ============================
   CATEGORY-SPECIFIC CONTENT
   ============================ */
const categoryContent = {
    makhana: {
        tagline: "The Ancient Snack That's Making a Comeback",
        description:
            "Hand-picked from lotus farms of Bihar, roasted to perfection the traditional way.",
        badge: "Sustainably Harvested",
    },
    sattu: {
        tagline: "The Protein Secret of India's Strongest Athletes",
        description:
            "Premium roasted gram flour, packed with natural protein and nutrients.",
        badge: "üí™ Natural Protein Source",
    },
};

const content = categoryContent[type];

/* ============================
   STRUCTURED DATA FOR SEO
   ============================ */
const structuredData = JSON.stringify(
    {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        name: `${categoryName} | Farmpure`,
        url: `https://www.farmpure.net/category/${type}`,
        description: `Explore Farmpure's range of ${categoryName} products, pure, natural, and rich in nutrition.`,
        inLanguage: "en-IN",
        isPartOf: {
            "@type": "WebSite",
            name: "Farmpure",
            url: "https://www.farmpure.net/",
        },
        publisher: {
            "@type": "Organization",
            name: "Farmpure",
            url: "https://www.farmpure.net/",
            logo: {
                "@type": "ImageObject",
                url: "https://www.farmpure.net/assets/shared/logo.webp",
            },
            sameAs: [
                "https://www.facebook.com/people/Farm-Pure/61566574773069/",
                "https://in.linkedin.com/company/slb-overseas-llp",
                "https://www.instagram.com/farmpureofficial/",
            ],
            contactPoint: {
                "@type": "ContactPoint",
                telephone: "+91-8700522344",
                contactType: "Customer Service",
                areaServed: "IN",
                availableLanguage: "en",
            },
        },
        mainEntity: {
            "@type": "ItemList",
            name: `${categoryName} Products`,
            itemListElement: data
                .filter(({ category }) => category === type)
                .map((item, index) => ({
                    "@type": "ProductCollection",
                    name: item.name,
                    url: `https://www.farmpure.net/products/${item.slug}`,
                    image: item.image.startsWith("http")
                        ? item.image
                        : `https://www.farmpure.net${item.image}`,
                    description: `Explore Farmpure ${item.name}, part of our ${categoryName} range of pure, natural, and traditional Indian superfoods.`,
                    brand: { "@type": "Brand", name: "Farmpure" },
                    position: index + 1,
                })),
        },
    },
    null,
    2,
);
---

<Layout title=`Farmpure ${categoryName} Products Catalog`>
    <Fragment slot="head">
        <script type="application/ld+json" set:html={structuredData} />
    </Fragment>

    <main>
        <!-- Hero Section -->
        <section class="bg-gradient-to-b from-amber-50 to-white py-16 pt-4">
            <div class="container !max-w-[900px] mx-auto text-center">
                <div class="inline-block mb-4">
                    <span
                        class="animate-pulse rounded-full bg-green-50 px-4 py-2 text-sm font-semibold text-green-700"
                    >
                        {content.badge}
                    </span>
                </div>
                <Text type="h1" className="mb-4" color={colors.dark}>
                    {categoryName}
                </Text>
                <p class="text-xl md:text-2xl font-medium text-gray-700 mb-3">
                    {content.tagline}
                </p>
                <p class="text-gray-600 max-w-2xl mx-auto">
                    {content.description}
                </p>
            </div>
        </section>

        <!-- Product Grid -->
        <section class="px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-16 gap-y-8">
                {
                    data
                        .filter(({ category }) => category === type)
                        .map((item) => (
                            <div class="w-full flex flex-col items-center bg-white rounded-2xl border-2 border-transparent py-2 shadow-sm transition-all duration-300 hover:border-green-500 hover:-translate-y-1 hover:shadow-xl">
                                <Image
                                    src={item.image}
                                    width={750}
                                    height={750}
                                    class="w-[150vw] md:w-full md:min-w-[75vw] md:max-w-[700px] lg:min-w-[50vw] mb-4 md:mb-0 h-auto aspect-[2/1] object-contain"
                                    alt={`${item.name} image`}
                                />
                                <div class="w-full max-w-[400px] p-1">
                                    <Text
                                        type="h2"
                                        className="text-center !text-3xl !font-semibold"
                                    >
                                        {item.name}
                                    </Text>
                                </div>
                                <div class="flex justify-center mt-4">
                                    <a href={`/products/${item.slug}`}>
                                        <Button type="secondary-inverted">
                                            SEE PRODUCT
                                        </Button>
                                    </a>
                                </div>
                            </div>
                        ))
                }
            </div>
        </section>

        <!-- Trust Indicators -->
        <section class="bg-gray-50 py-12 px-4">
            <div class="container !max-w-[1200px] mx-auto">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                    <div
                        class="bg-white rounded-xl p-6 text-center shadow-sm transition-all duration-300 hover:-translate-y-0.5 hover:shadow-[0_10px_25px_rgba(0,0,0,0.1)]"
                    >
                        <div class="text-3xl mb-2">üî¨</div>
                        <div class="text-sm font-semibold text-gray-900">
                            Lab Tested
                        </div>
                        <div class="text-xs text-gray-600 mt-1">
                            Quality Assured
                        </div>
                    </div>
                    <div
                        class="bg-white rounded-xl p-6 text-center shadow-sm transition-all duration-300 hover:-translate-y-0.5 hover:shadow-[0_10px_25px_rgba(0,0,0,0.1)]"
                    >
                        <div class="text-3xl mb-2">ü§ù</div>
                        <div class="text-sm font-semibold text-gray-900">
                            Farm Direct
                        </div>
                        <div class="text-xs text-gray-600 mt-1">
                            No Middlemen
                        </div>
                    </div>
                    <div
                        class="bg-white rounded-xl p-6 text-center shadow-sm transition-all duration-300 hover:-translate-y-0.5 hover:shadow-[0_10px_25px_rgba(0,0,0,0.1)]"
                    >
                        <div class="text-3xl mb-2">üîí</div>
                        <div class="text-sm font-semibold text-gray-900">
                            100% Pure
                        </div>
                        <div class="text-xs text-gray-600 mt-1">
                            Zero Additives
                        </div>
                    </div>
                    <div
                        class="bg-white rounded-xl p-6 text-center shadow-sm transition-all duration-300 hover:-translate-y-0.5 hover:shadow-[0_10px_25px_rgba(0,0,0,0.1)]"
                    >
                        <div class="text-3xl mb-2">üå±</div>
                        <div class="text-sm font-semibold text-gray-900">
                            Sustainable
                        </div>
                        <div class="text-xs text-gray-600 mt-1">
                            Eco-Friendly
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Category Benefits -->
        <section
            class="bg-gradient-to-b from-white to-gray-50 px-6 py-16"
            aria-labelledby="benefits-heading"
        >
            <div class="mx-auto max-w-6xl">
                <div class="mb-12 text-center">
                    <Text
                        type="h2"
                        color={colors.dark}
                        className="mb-3"
                        id="benefits-heading"
                    >
                        Health Benefits of {categoryName}
                    </Text>
                    <Text
                        type="body"
                        color={colors.gray}
                        className="mx-auto max-w-2xl"
                    >
                        Backed by centuries of tradition and modern nutritional
                        science
                    </Text>
                </div>

                <div class="flex justify-center">
                    {
                        type === "makhana" ? (
                            <MakhanaBenefits />
                        ) : (
                            <SattuBenefits />
                        )
                    }
                </div>
            </div>
        </section>

        <FeaturedProducts />
        <Outro />
    </main>

    <Footer />
</Layout>
